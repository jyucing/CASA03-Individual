<!DOCTYPE html>
<html>
  <head>
    <title>Global Tourism's Recovery from COVID-19</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
  </head>
    
  <body>
    <svg width="1600" height="800" id="mainsvg" class="svgs"></svg>
      
    <script>

    let svg = d3.select('svg');
    const width = +svg.attr('width');
    const height = +svg.attr('height');
    const margin = {top: 60, right: 60, bottom: 10, left: 60};
    const innerWidth = width - margin.left - margin.right;
    const innerHeight = height - margin.top - margin.bottom;
    const g = svg.append('g').attr('id', 'maingroup')
    .attr('transform', `translate(${margin.left}, ${margin.top})`);

    // convert dataPath to svgPath; 
    const projection = d3.geoNaturalEarth1();
    //const projection = d3.geoTransverseMercator();
    const pathGenerator = d3.geoPath().projection(projection);

    // setting up the tip tool; 
    //const tip = d3.tip()
    //.attr('class', 'd3-tip').html(function(d) { return d.properties.name });
    //svg.call(tip);

    let worldmeta;
    //let lastid = undefined;

    d3.json('https://raw.githubusercontent.com/jyucing/CASA03-IW/main/Data/ITA.geojson').then(
        function(data){

            worldmeta = data;
            
            // this code is really important if you want to fit your geoPaths (map) in your SVG element; 
            projection.fitSize([innerWidth, innerHeight], worldmeta);

            // perform data-join; 
            const paths = g.selectAll('path')
            .data(data.features, d => d.properties.country)
            .enter().append('path')
            .attr('d', pathGenerator)
            .attr('fill', 'black')
            .attr('stroke', 'white')
            .attr('stroke-width', 1)
            .on('mouseover',function(d){
              d3.select(this)
              .attr("opacity", 0.5)
              .attr("stroke","white")
              .attr("stroke-width", 2);
            })
            .on('mouseout', function(d){
              d3.select(this)
              .attr("opacity", 1)
              .attr("stroke","black")
              .attr("stroke-width",1);
            })
            //.on('click', function(d){
              //d3.event.preventDefault();
              //if(lastid !== d.properties.country){
                //tip.show(d)
                //lastid = d.properties.country;
              //}else{
                //tip.hide(d)
              //}
            //})
        }
    );

  </script>
  </body>
</html>